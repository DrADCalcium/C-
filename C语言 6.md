# C语言第九节&第十节-顺序结构&选择结构

+++

## 赋值运算符和赋值表达式

1. 右边表达式与左边变量的类型不一致时，将右边的值转换为左边变量的类型
2. 实型转换为整型时，会截去小数部分，保留整数
3. 赋值运算符有右结合性

`a = b = c = 8`等效于`a = (b = (c = 8))`

## 复合赋值运算符

赋值运算符`=`前加其他双目运算符

`+=、-=、*=/=、%=、>>=、<<=、&=、^=、|=`

`a += 5`相当于`a = a + 5`

`a *= 5`相当于`a = a * 5`

`a += a -= a * a`相当于`a = a + (a = (a - a * a))`

## 逗号运算符和表达式

`,`将两个表达式连接起来组成一个表达式

1. 求值过程是从左向右求表达式的值,并以**表达式2**的值作为整个逗号表达式的值

> 表达式`3 + 5,6 + 8`的值为14

2. 逗号运算符是所有运算符中级别最低的
3. 逗号运算符可由多个表达式组成

## 数据类型的转换

+ 自动类型转换
+ 强制类型转换

### 自动类型转换

1. int和long一起运算时，int -> long
2. float必须转换成double
3. char和short必须转换成int
4. 在赋值运算中，当赋值号两边的数据类型不同时，赋值号右边数据的类型将转换为左边数据的类型

> 字节数少的数据类型自动向字节数多的数据类型转换时，不丢失数据。
>
> 字节数多的数据类型自动向字节数少的数据类型转换时，可能会丢失部分信息。

### 强制类型转换

**(类型名) 表达式**

1. 把表达式的运算结果强制转换成类型名所指定的类型
2. 强制类型转换运算符的优先级高于算术运算符
3. 强制类型转换只会对结果进行临时转换，而不会改变变量的数据类型

## 语句

语句用于向计算机软硬件系统发出操作指令以完成一定任务.

C语言的每一条语句后都必须跟一个分号`;`

1. 控制语句
2. 函数调用语句
3. 表达式语句
4. 空语句
5. 复合语句

> 用花括号`{}`括起来的多条语句构成了复合语句
>
> ```c
> {
>     t = a;
>     a = b;
>     b = t;
> }
> ```

## 注释

1. 单行注释 `//单行注释`
2. 多行注释 `/*多行注释*/`

+++

# 选择结构

### 【例5.1】

```flow
st=>start: 开始
op1=>operation: y = x
op2=>operation: y = 2x - 1
cond=>condition: x < 1 ?
io1=>inputoutput: 输入x
io2=>inputoutput: 输出y
e=>end: 结束
st->io1->cond
cond(yes)->op1->io2->e
cond(no)->op2->io2->e

```

```c
#include <stdio.h>
int main()
{
    float x,y = 0;
    printf("Please input x=");
    scanf("%f",&x);
    y = 2*x-1;//先赋值，不满足条件的情况修改
    if(x < 1)
        y = x;//单语句，无需加“{}”
    printf("y =%f\n",y);
	return 0;
}
```

## 关系运算与逻辑运算

关系运算可比较两个数据的关系

关系运算符用于比较两个操作数的关系

用关系运算符连接两个表达式称为关系表达式

C语言中关系表达式的值为`1`或`0`,分别表示`真`或`假`

| 运算符 |   运算   | 优先级 |
| :----: | :------: | :----: |
|  `>`   |   大于   |   高   |
|  `<`   |   小于   |        |
|  `>=`  | 大于等于 |        |
|  `<=`  | 小于等于 |        |
|  `==`  |   等于   |        |
|  `!=`  |  不等于  |   低   |

关系运算符优先级低于算术运算符,高于赋值运算符

## 逻辑运算符与逻辑表达式

逻辑运算用于对操作数进行逻辑运算

用逻辑运算符连接的关系表达式称为逻辑表达式

| 运算符 | 含义      | 说明                       |
| ------ | --------- | -------------------------- |
| `&&`   | 与 (并且) | 两个操作数都为真, 结果为真 |
| `||`   | 或 (或者) | 两个操作数都为假, 结果为假 |
| `!`    | 非 (取反) | 操作数为真, 结果为假       |

| `a`  | `b`  | `!a` | `a&&b` | `a||b` |
| :--: | :--: | :--: | :----: | :----: |
|  1   |  1   |  0   |   1    |   1    |
|  1   |  0   |  0   |   0    |   1    |
|  0   |  1   |  1   |   0    |   1    |
|  0   |  0   |  1   |   0    |   0    |

## 运算符优先顺序

|         运算符         | 优先级 |
| :--------------------: | :----: |
|        非 `(!)`        |   高   |
|       算术运算符       |        |
|       关系运算符       |        |
| 与 `(&&)` 和 或 `(||)` |        |
|       赋值运算符       |   低   |

如果优先级不清楚, 可以用小括号`()`进行表达

## *短路求值

【例5.9】

```c
#include <stdio.h>

int main()
{
    int a,b,c,d;
    a = 4,b = 5;
    d = ( a < 0 )&&( b = 10 );
    printf("%d %d\n",d,b);
    d = ( a > 0 )||( b = 0 );
    printf("%d %d\n",d,b);
    return 0;
}
```

## `if`语句

`if`语句会判断条件的真假，决定执行的语句

```c
if(/*逻辑条件*/)
	{/*执行语句1*/}
else
	{/*执行语句2*/}
```

或

```c
if(/*逻辑条件1*/)
	{/*执行语句1*/}
else if(/*逻辑条件2*/)
	{/*执行语句2*/}
......
```

案例见**例5.1**

+ 一个分支中只有单语句可不加花括号`{}`，但多语句必须加
+ `if`与`else`必须匹配，`else`不可单独出现
+ 判定条件必须用小括号`()`包括
+ 注意`if`与`else`的分支缩进一个Tab

### 【例5.15】

```flow
st=>start: 开始
io1=>inputoutput: 输入a,b
io2=>inputoutput: 输出y
cond=>condition: a > b ?
op1=>operation: y = a
op2=>operation: y = b
e=>end: 结束
st->io1->cond
cond(yes)->op1->e
cond(no)->op2->e
```

```c
#include <stdio.h>

int max(int a,int b)
{
    int y;//函数可以是选择结构
    if(a>b)
        y = a;
    else
        y = b;
    return y;
}
int main()
{
    int a,b,c;
    printf("Please input a,b:");
    scanf("%d%d\n",&a,&b);
    c = max(a,b);
    printf("max = %d\n",c);
    return 0;
}
```

## `switch`语句

`switch`语句是一种多分支语句，它用于编写选择分支较多的程序

```c
switch(/*变量或表达式*/)
{
    case /*常量表达式1*/:/*语句1*/
    case /*常量表达式2*/:/*语句2*/
    default:/*语句n*/
}
```

+ 当`switch`的“变量表达式”的值与`case`子句后的“常量表达式”相等时，就执行`case`后的语句
+ 当所有的“常量表达式”的值都不与“变量或表达式”的值相等，则执行`default`后面的语句
+ `switch`后边的表达式中的变量只能是**整型或者字符型**
+ `case`后边**必须为常量或常量表达式**，且case后边的常量或常量表达式必须互不相同，否则将因为冲突而导致语法错误

```c
switch(mark)
{
    case 2:printf("xx");
    case 1+1:printf("yy");//两个case后的常量均为2，故报错
    default:printf("zz");
}
```

+ 各个`case`和`default`的先后次序不会影响的运行
+ 每个`case`分支后边可以有多条语句
+ ***执行完一个`case`后面的语句以后，将继续执行下一个`case`后面的语句。***可以在每个`case`对应语句的后面用一个break语句使得执行流程跳出`switch`结构
+ 如果匹配的`case`分支后面没有语句，将继续执行下一个`case`后面的语句

### `break`演示

在每个`case`的语句后边跟一个`break`语句，则不再继续执行下一个`case`后的语句

```c
#include <stdio.h>
int main()
{
    char mark;
    printf("Please input mark:");
    scanf("%c",&mark);//输入成绩等级
    switch(mark)//判断mark的情况
    {
        case 'A':printf("90~100\n");
            break;
        case 'B':printf("80~89\n");
            break;
        case 'C':printf("70~79\n");
            break;
        case 'D':printf("60~69\n");
            break;
        case 'E':printf("0~59\n");
            break;
        default:printf("Error\n");
    }
    return 0;
}
```

### 【例】判断点所在象限

```c
#include "stdio.h"

int main()
{
    int x=0,y=0;
    printf("\nPlease input x,y:");
    scanf("%d%d",&x,&y);
    
    
}
```

## 选择结构的嵌套

`if`语句中又包含一个或多个`if`语句的形式

`if`与`else`配对关系：`else`总是与它最前面最近的未配对的`if`配对

编程时如果`if`与`else`数目不同，程序员可以用花括号`{}`来确定其配对关系

### 【例5.22】编写例5.1的程序，求函数的值。

```c
#include "stdio.h"

int main()
{
    float x,y;
    printf("\nPlease  nput x:");
    scanf("%f",&x);
    
    if(x>=1)
        if(x<10)
            y = x*x+2*x+2;
    else
        y = x;
    
    printf("y = %f\n",y);
    return 0;
}
```

### 【例5.23】程序设计实例

停车场规定如下：

1. 如果车辆是货运车辆，那么重量小于等于2吨的收费10元，大于2吨的谢绝入内；
2. 如果车辆是客运车辆，乘员数量小于等于7人，则收费5元，如果乘员数量大于7人，则收费10元。

编写程序输入车辆类型，吨数或乘员数量，根据停车场的规定，判断该车是否可以进入，收费多少元？

```flow
st=>start: 开始
io1=>inputoutput: 输入车辆类型
io2=>inputoutput: 输入货车重量
io3=>inputoutput: 输入客车乘员数量
io2-1=>inputoutput: 输出"禁止进入"
io2-2=>inputoutput: 输出"收费10元"
io3-1=>inputoutput:  输出"收费10元"
io3-2=>inputoutput: 输出"收费5元"

cond1=>condition: 是否为货车？
cond1-1=>condition: 重量是否大于2吨？
cond2-1=>condition: 乘员数量是否大于7人？

e=>end: 结束

st->io1->cond1
cond1(yes)->io2->cond1-1
cond1-1(yes)->io2-1->e
cond1-1(no)->io2-2->e
cond1(no)->io3->cond2-1
cond2-1(yes)->io3-1->e
cond2-1(no)->io3-2->e
```

```c
#include "stdio.h"

int main()
{
    int m,t,n,p;
    printf("请输入车型（1~货车，2~客车）");
    scanf("%d",&m);
    
    if(m==1)
    {
        printf("请输入吨数：")
        scanf("%d",&t);
        
        if(t<=2)
            printf("停车费为10元\n");
        else
            printf("禁止入内\n");
    }
    else
    {
        printf("请输入乘员数:");
        scanf("%d",&n);
        
        if(n<=7)
            p=5;
        else
            p=10;
        printf("该车的停车费为%d元\n",p);
    }
    return 0;
}
```

## 条件运算符 (C++) - 三目运算符

```
Exp1 ? Exp2 : Exp3;
```

其中，Exp1、Exp2 和 Exp3 是表达式。请注意冒号的使用和位置。? : 表达式的值取决于 Exp1 的计算结果。如果 Exp1 为真，则计算 Exp2 的值，且 Exp2 的计算结果则为整个 ? : 表达式的值。如果 Exp1 为假，则计算 Exp3 的值，且 Exp3 的计算结果则为整个 ? : 表达式的值。

1. 条件运算符的优先级高于赋值运算符，低于关系运算符和算术运算符
	`max = x > y ? x : y + 1;`相当于`max = ( x > y ) ? x : ( y + 1 );`

2. 条件运算符按照“自右向左”的顺序结合
    `a > b ? a : c > d ? c : d;`相当于`a > b ? a : ( c > d ? c : d );`

3. 条件表达式写为以下形式
	`z = x > y ? ( x = 100 ) : ( y = 100 );`

【例】

```c
if(y < 10){ 
   var = 30;
}else{
   var = 40;
}
```

可被替换为

```c
var = (y < 10) ? 30 : 40;
```

如果x=5、y=4，那么语句运行时表达式（y=100）不执行，所以语句运行后z为100，x为100，y为4。

​	
