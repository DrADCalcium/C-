# C语言第十三节-函数

***

#### 【例4.1】定义函数`fun()`，参数为价格和重量，求樱桃的总金额

```c
int fun(int p,int n)
{
    int t;
    t = p*n;
    return (t);
}
```

+ **返回类型：**一个函数可以返回一个值。*修饰符*是函数返回的值的数据类型。有些函数执行所需的操作而不返回值，在这种情况下，`修饰符` 是关键字 `void`。
+ **函数名称：**这是函数的实际名称。函数名和参数列表一起构成了函数签名。
+ **参数：**参数就像是占位符。当函数被调用时，您向参数传递一个值，这个值被称为实际参数。参数列表包括函数参数的类型、顺序、数量。参数是可选的，也就是说，函数可能不包含参数。
+ **函数主体：**函数主体包含一组定义函数执行任务的语句。

### *函数简单预定义

可以用预处理命令 define 来定义简单函数：

```c
#define  MAX_3(a, b, c) ( ((a > b ? a : b) > c) ? (a > b ? a : b) : c )
#define  MIN_3(a, b, c) ( ((a < b ? a : b) < c) ? (a < b ? a : b) : c )
#define  MAX_2(x, y)  ( x> y ? x : y )
#define  MIN_2(x, y)  ( x< y ? x : y )
#define  ARR_SIZE(a)  ( sizeof( (a) ) / sizeof( (a[0]) ) )
#define  MULTIPLE(m, n) ( (m%n == 0)?0:1 )
#define  AVE_3(a, b, c) (a+b+c)/3
#define  SUM_3(a, b, c) a+b+c
#define  SWAP(a, b){int t= a;a=b;b=t;}
```

## 函数参数

如果函数要使用参数，则必须声明接受参数值的变量。这些变量称为函数的**形式参数**。

形式参数就像函数内的其他局部变量，在进入函数时被创建，退出函数时被销毁。

当调用函数时，有两种向函数传递参数的方式：

| **调用类型** | **描述**                                                     |
| ------------ | ------------------------------------------------------------ |
| 传值调用     | 该方法把参数的实际值复制给函数的形式参数。在这种情况下，修改函数内的形式参数不会影响实际参数。 |
| 引用调用     | 通过指针传递方式，形参为指向实参地址的指针，当对形参的指向操作时，就相当于对实参本身进行的操作。 |



### 内部函数

如果一个函数只能被本文件中其他函数所调用，它称为内部函数。在定义内部函数时，在函数名和函数类型的前面加 static，即

```c
static /*类型名*/ /*函数名*/ /*（形参表）*/
```

内部函数又称静态函数。使用内部函数，可以使函数的作用域只局限于所在文件。即使在不同的文件中有同名的内部函数，也互不干扰。提高了程序的可靠性。

### 外部函数

如果在定义函数时，在函数的首部的最左端加关键字 extern，则此函数是外部函数，可供其它文件调用。

如函数首部可以为

```c
extern int max (int a,int b)
```

C 语言规定，如果在定义函数时省略 extern，则默认为外部函数。

在需要调用此函数的其他文件中，需要对此函数作声明（不要忘记，即使在本文件中调用一个函数，也要用函数原型来声明）。在对此函数作声明时，要加关键字 extern，表示该函数是在其他文件中定义的外部函数。

### 内联函数

内联函数是指用inline关键字修饰的函数。在类内定义的函数被默认成内联函数。内联函数从源代码层看，有函数的结构，而在编译后，却不具备函数的性质。

内联扩展是用来**消除函数调用**时的时间开销。它通常用于频繁执行的函数，对于小内存空间的函数非常受益。

使用内联函数的时候要注意：

+ 递归函数不能定义为内联函数

+ 内联函数一般适合于不存在while和switch等复杂的结构且只有1~5条语句的小函数上，否则编译系统将该函数视为普通函数。

+ 内联函数只能先定义后使用，否则编译系统也会把它认为是普通函数。

+ 对内联函数不能进行异常的接口声明。

## 参数传递

### 值传递

```c
#include <stdio.h>

void swap(int x, int y);
void swap(int x, int y)
{
    int temp;
    temp = x;
    x = y;
    y = temp;
}

int main( int argc, char *argv[] )
{
    int a = 5;
    int b = 10;
    swap(a, b); //调用交换函数
    printf("交换结果为 a = %d, b = %d\n",a,b);
    return 0;
}
```

由于值传递是单向传递，传递过程中只是改变了形参的数值，并未改变实参的数值，因此并不会改变a和b原有的值。

### 指针传递

```c
#include <stdio.h>

void swap(int *x, int *y);
void swap(int *x, int *y)
{
    int temp;
    temp = *x;
    *x = *y;
    *y = temp;
}

int main( int argc, char *argv[] )
{
    int a = 5;
    int b = 10;
    swap(&a, &b); //调用交换函数
    printf("交换结果为 a = %d, b = %d\n",a,b);
    return 0;
}
```

指针传递过程中，将a和b的地址分别传递给了x和y，在函数体内部改变了a、b所在地址的值，即交换了a、b的数值。

## 占位符

+ **`%d, %i`** 代表整数
+  **`%f`** 浮点
+  **`%s`** 字符串
+  **`%c`** char
+  **`%p`** 指针
+  **`%fL`** 长log
+  **`%e`** 科学计数
+  **`%g`** 小数或科学计数。
+  **`%a,%A`** 读入一个浮点值(仅C99有效)。
+  **`%c`** 读入一个字符。
+  **`%d`** 读入十进制整数。
+  **`%i`** 读入十进制，八进制，十六进制整数。
+  **`%o`** 读入八进制整数。
+  **`%x,%X`** 读入十六进制整数。
+  **`%s`** 读入一个字符串，遇空格、制表符或换行符结束。
+  **`%f,%F,%e,%E,%g,%G`** 用来输入实数，可以用小数形式或指数形式输入。
+  **`%p`** 读入一个指针。
+  **`%u`** 读入一个无符号十进制整数。
+  **`%n`** 至此已读入值的等价字符数。
+  **`%[]`** 扫描字符集合。
+  **`%%`** 读 % 符号

## `math.h`

| 函数        | 说明                             |
| ----------- | -------------------------------- |
| `sqrt(x)`   | x的平方根                        |
| `cbrt(x)`   | x的立方根                        |
| `exp(x)`    | 指数函数e^x                      |
| `log(x)`    | x的自然对数                      |
| `log10(x)`  | x的对数                          |
| `fabs(x)`   | 以浮点数表示的x的绝对值          |
| `ceil(x)`   | 对x向上取整得到不小于x的最小整数 |
| `floor(x)`  | 对x向下取整得到不大于x的最大整数 |
| `pow(x,y)`  | x的y次幂                         |
| `fmod(x,y)` | 以浮点数表示的x/y的余数          |
| `sin(x)`    | x的正弦值（x以弧度表示）         |
| `cos(x)`    | x的余弦值（x以弧度表示）         |
| `tan(x)`    | x的正切值（x以弧度表示）         |

## 变量作用域

### 局部变量

在某个函数或块的内部声明的变量称为局部变量。它们只能被该函数或该代码块内部的语句使用。局部变量在函数外部是不可知的。下面是使用局部变量的实例。在这里，所有的变量 a、b 和 c 是 main() 函数的局部变量。

```c
#include <stdio.h>
 
int main ()
{
  /* 局部变量声明 */
  int a, b;
  int c;
 
  /* 实际初始化 */
  a = 10;
  b = 20;
  c = a + b;
 
  printf ("value of a = %d, b = %d and c = %d\n", a, b, c);
 
  return 0;
}
```

